/* RV32I no_std linker script for simple VM */

ENTRY(_start);

MEMORY
{
    /* RAM starts at 0x1000 and is 800 KB */
    RAM (rwx) : ORIGIN = 0x00001000, LENGTH = 800K
}

/* Stack size */
_stack_size = 8K; 

/* Stack bounds */
_stack_end   = ORIGIN(RAM) + LENGTH(RAM);  /* top of RAM */
_stack_start = _stack_end - _stack_size;   /* bottom of stack */

/* Sections */
SECTIONS
{
    /* --- Text section --- */
    .text : ALIGN(4)
    {
        /* Place _start first */
        KEEP(*(.text._start))
        
        /* All other text */
        *(.text .text.*)
        
        /* Read-only data inside text if needed */
        *(.rodata .rodata.*)
    } > RAM

    /* --- Initialized data --- */
    .data : ALIGN(4)
    {
        *(.data .data.*)
    } > RAM

    /* --- Uninitialized data --- */
    .bss (NOLOAD) : ALIGN(4)
    {
        *(.bss .bss.*)
        . = ALIGN(4);
    } > RAM

    /* --- Stack (symbol only, no load) --- */
    .stack (NOLOAD) : ALIGN(8)
    {
        _stack_bottom = _stack_start;
        . = _stack_end;
    } > RAM
}
